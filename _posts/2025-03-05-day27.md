---
title: "[Day27] ì¤‘ìš” ì •ë³´ ì²˜ë¦¬ & íšŒì› ê°€ì…"
categories: [Ureca, SQL]
tags: [SQL]
image:
  path: /assets/post/2025/ureca/day27_res_3.png
  alt: sql
published: true
---

ì˜¤ëŠ˜ì€ ë°±ì—”ë“œì—ì„œ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ë°°ì› ë‹¤. <br/>
ìœ ë ˆì¹´ êµìœ¡ì´ ì‹œì‘í•œ í›„ ê³„ì†í•´ì„œ ë³´ì•ˆì˜ ì¤‘ìš”ì„±ì— ëŒ€í•´ ë“¤ì—ˆì§€ë§Œ, ì§ì ‘ ì½”ë“œì— ì ìš©ì„ í•´ë³¸ ê²½í—˜ì€ ì²˜ìŒì´ë¼ ì–´ë–¤ ë³´ì•ˆì´ ì¤‘ìš”í•˜ê³ , ì´ë¥¼ ì–´ë–»ê²Œ ì ìš©í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. 
<br/><br/>
ì˜¤í›„ì—ëŠ” íšŒì› ê°€ì…ê³¼ ë¡œê·¸ì¸ ê¸°ëŠ¥ê¹Œì§€ êµ¬í˜„ì„ í–ˆë‹¤.<br/>
ë­”ê°€ í’€ìŠ¤íƒìœ¼ë¡œ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ”ê±°ê°™ì•„ì„œ ì‹ ê¸°í•˜ê¸°ë„ í–ˆì§€ë§Œ ë‚´ê°€ ì´í•´ë¥¼ í•˜ëŠ”ê²Œ ë§ë‚˜ ì‹¶ê³ , 
ë°±ì—”ë“œ ì½”ë“œì— ëŒ€í•´ ìê¾¸ë§Œ ì˜ë¬¸ì´ ìƒê²¨ì„œ ì˜¤ëŠ˜ì€ ë¨¸ë¦¬ê°€ ì™„ì „ ê³¼ë¶€í•˜ì˜€ë‹¤,,<br/>
ì¬ë°Œì§€ë§Œ ë¨¸ë¦¬ëŠ” ì•„í”ˆ..<br/>
ì•„ë¬´íŠ¼ ë¡œê·¸ì¸ ê¸°ëŠ¥ì€ ì´í•´ê°€ ì¢€ ì•ˆë˜ì„œ ë‚´ì¼ ë‹¤ì‹œ ë“£ê³  ì •ë¦¬í•´ì•¼ê² ë‹¤ !

---

## Spring Bootì—ì„œ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ëŠ” ë°©ë²•

- DB ì ‘ì† ì •ë³´(ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸ ë“±)ëŠ” ì½”ë“œì— ì§ì ‘ ì ì§€ ì•ŠëŠ”ë‹¤.
- .properties íŒŒì¼ì„ í™œìš©í•˜ì—¬ ë³„ë„ë¡œ ê´€ë¦¬í•œë‹¤.
- .gitignoreë¥¼ ì´ìš©í•´ ë³´ì•ˆì´ í•„ìš”í•œ íŒŒì¼ì„ Gitì— ì˜¬ë¦¬ì§€ ì•ŠëŠ”ë‹¤.

### src/main/resources/config/secu.properties
ğŸ‘‰ DB ì ‘ì† ì •ë³´ë¥¼ ë³„ë„ì˜ ì„¤ì • íŒŒì¼ì— ì €ì¥
<br/>

+ ë³´ì•ˆ ê°•í™”ë¥¼ ìœ„í•´ ë”°ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì .
+ ì‹¤ë¬´ì—ì„œëŠ” secu ê°™ì€ ì´ë¦„ë³´ë‹¤ ì¼ë°˜ì ì¸ ì„¤ì • íŒŒì¼ì²˜ëŸ¼ ë³´ì´ë„ë¡ ë‹¤ë¥¸ ì´ë¦„ì„ ì‚¬ìš©í•˜ê¸°ë„ í•¨.

```jsx
DB_DRIVER=com.mysql.cj.jdbc.Driver
DB_URL=jdbc:mysql://localhost:3306/ureca?serverTimezone=UTC
DB_USER=ureca
DB_PW=ureca
```

### src/main/resources/application.properties
ğŸ‘‰ `secu.properties`ì— ì €ì¥ëœ ê°’ì„ ê°€ì ¸ì™€ì„œ Spring Bootì˜ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •ìœ¼ë¡œ ì‚¬ìš©
<br/>

- `${}` ë¬¸ë²•ì„ ì´ìš©í•´ `secu.properties`ì˜ ê°’ë“¤ì„ ë¶ˆëŸ¬ì˜´.

```java
spring.datasource.driver-class-name=${DB_DRIVER}
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PW}
```

### com.shop.cafe.Project1CafeApplication.java
ğŸ‘‰ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì§„ì…ì  (Main Class)
- `@PropertySource("classpath:config/secu.properties")`ë¥¼ í†µí•´ `secu.properties` íŒŒì¼ì„ ë¡œë“œ.
- ì´ ì„¤ì • ë•ë¶„ì— `application.properties`ì—ì„œ `${DB_DRIVER}` ê°™ì€ ê°’ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.

```java
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.PropertySource;

@SpringBootApplication
@PropertySource("classpath:config/secu.properties")
public class Project1Cafe2Application {

	public static void main(String[] args) {
		SpringApplication.run(Project1Cafe2Application.class, args);
	}
}
```

### .gitignore
ğŸ‘‰ ë³´ì•ˆ íŒŒì¼(`secu.properties`)ì„ Gitì— ì˜¬ë¦¬ì§€ ì•Šë„ë¡ ì„¤ì •
- `**/config/*.properties` íŒ¨í„´ì„ ì¶”ê°€í•˜ì—¬ `config` í´ë” ì•ˆì˜ `.properties` íŒŒì¼ì€ Gitì— í¬í•¨ë˜ì§€ ì•Šë„ë¡ í•¨.

```java
**/config/*.properties
```

<img src="/assets/post/2025/ureca/day27_class_2.png" alt='' width=1300px>

ğŸ’¡ ë§¥ë¶ì—ì„œëŠ” .gitignore íŒŒì¼ì´ ì•ˆë³´ì—¬ì„œ í„°ë¯¸ë„ì—ì„œ `ls` ëª…ë ¹ì–´ë¡œ í•´ë‹¹ íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•œ í›„,
`vim .gitignore`ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ í•´ë‹¹ ì½”ë“œë¥¼ ì¶”ê°€í–ˆë‹¤.

### ProductDao.java
ğŸ‘‰ DBì—ì„œ ì œí’ˆ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” DAO (Data Access Object)
- `@Value`ë¥¼ ì´ìš©í•´ `application.properties`ì—ì„œ DB ì„¤ì • ê°’ì„ ê°€ì ¸ì˜´.

Q. ì™œ ì§ì ‘ `DB_DRIVER`, `DB_URL`, `DB_USER`, `DB_PW` ê°’ì„ ì ì§€ ì•Šê³  `@Value`ë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?      
A. ë³´ì•ˆ ê°•í™”ë¥¼ ìœ„í•´ DB ì •ë³´ë¥¼ ì½”ë“œì— í•˜ë“œì½”ë”©í•˜ì§€ ì•Šê¸° ìœ„í•´ì„œ!

```java
import java.sql.*;
import java.util.*;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;
import org.springframework.stereotype.Repository;
import org.springframework.web.bind.annotation.CrossOrigin;

import com.shop.cafe.dto.Product;
// @Component // ê°ì²´ ìƒì„±ê³¼ ì‚­ì œë¥¼ í”„ë ˆì„ì›Œí¬ì— ì˜ì§€í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë˜ê² ë‹¤.
@Repository 
// ì €ì¥ì†Œ ì»´í¬ë„ŒíŠ¸ì„ì„ ì•Œë¦¼.
public class ProductDao {
	// Productì—ê²Œ ë¶€íƒí•˜ëŠ” ê²ƒì„.
	@Value("${spring.datasource.driver-class-name}")
	private String DB_DRIVER;
	
	@Value("${spring.datasource.url}")
	private String DB_URL;
	
	@Value("${spring.datasource.username}")
	private String DB_USER;
	
	@Value("${spring.datasource.password}")
	private String DB_PW;
	
	public List<Product> getAllProducts() throws Exception{
		// JDBC 6ë‹¨ê³„
		// 1. ë“œë¼ì´ë²„ ë“±ë¡
		Class.forName(DB_DRIVER);
		
		String sql = "select * from product";
	
		// try-width-resources ê¸°ëŠ¥ auto closable ê°ì²´ë§Œ í‘œí˜„
		// ê°ì²´ ìƒì„± êµ¬ë¬¸ë§Œ try ì†Œê´„í˜¸ ì•ˆì— ë„£ì„ ìˆ˜ ìˆìŒ.
		try (
			// 2. ì—°ê²°
			Connection con=DriverManager.getConnection(DB_URL, DB_USER, DB_PW);
			// 3. Statement ìƒì„±
			PreparedStatement stmt=con.prepareStatement("select * from product");
			// 4. SQL ì „ì†¡
			ResultSet rs=stmt.executeQuery();
			){
			// 5. ê²°ê³¼ ë°›ê¸°
			List<Product> list = new ArrayList<>();
			
			while(rs.next()) {
				int prodcode = rs.getInt("prodcode");
				String prodname = rs.getString("prodname");
				String pimg = rs.getString("pimg");
				int price = rs.getInt("price");
				
				list.add(new Product(prodcode, prodname, pimg, price));
			}
			return list;
		} 
	}
}
```

<img src="/assets/post/2025/ureca/day27_class_1.png" alt='' width=1300px>


---

## íšŒì›ê°€ì… ì²˜ë¦¬
### ë°±ì—”ë“œ (BACK)
#### 1. ë°ì´í„°ë² ì´ìŠ¤ (MySQL) : Member í…Œì´ë¸” ìƒì„±
- registDateëŠ” íšŒì›ê°€ì… ì‹œê°„ì„ ìë™ ê¸°ë¡

```sql
create table member(
email varchar(50) primary key,
pwd varchar(256) not null,
nickname varchar(20) not null unique,
registDate timestamp default current_timestamp
);
```

#### 2. ë°ì´í„° ëª¨ë¸(DTO) : Member.java
- member í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ëŠ” ê°ì²´
- íšŒì› ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í•„ë“œ ë° getter, setter í¬í•¨

```java
package com.shop.cafe.dto;
import java.util.Date;

public class Member {
	private String email, pwd, nickname;
	private Date registDate;
	public String getEmail() {
		return email;
	}
	public void setEmail(String email) {
		this.email = email;
	}
	public String getPwd() {
		return pwd;
	}
	public void setPwd(String pwd) {
		this.pwd = pwd;
	}
	public String getNickname() {
		return nickname;
	}
	public void setNickname(String nickname) {
		this.nickname = nickname;
	}
	public Date getRegistDate() {
		return registDate;
	}
	public void setRegistDate(Date registDate) {
		this.registDate = registDate;
	}
	public Member() {
		super();
		// TODO Auto-generated constructor stub
	}
	public Member(String email, String pwd, String nickname, Date registDate) {
		super();
		this.email = email;
		this.pwd = pwd;
		this.nickname = nickname;
		this.registDate = registDate;
	}
	@Override
	public String toString() {
		return "Member [email=" + email + ", pwd=" + pwd + ", nickname=" + nickname + ", registDate=" + registDate
				+ "]";
	}
}
```

---

#### 3. ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ(DAO) : MemberDao.java 
ğŸ”¹ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°í•˜ì—¬ íšŒì› ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ì—­í•      

- `@Repository` : Springì—ì„œ DAO í´ë˜ìŠ¤ë¡œ ì¸ì‹í•˜ë„ë¡ ì„¤ì •
- DB ì—°ê²° ì •ë³´ë¥¼ @Valueë¥¼ í†µí•´ application.propertiesì—ì„œ ê°€ì ¸ì˜´
- SQL ì‹¤í–‰ : INSERT INTO ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ íšŒì› ì •ë³´ë¥¼ DBì— ì¶”ê°€

```java
package com.shop.cafe.dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Repository;

import com.shop.cafe.dto.Member;

@Repository // Repository component ì„ì„ ì•Œë ¤ì¤Œ
public class MemberDao {
	// Productì—ê²Œ ë¶€íƒí•˜ëŠ” ê²ƒì„.
	@Value("${spring.datasource.driver-class-name}")
	private String DB_DRIVER;
	
	@Value("${spring.datasource.url}")
	private String DB_URL;
	
	@Value("${spring.datasource.username}")
	private String DB_USER;
	
	@Value("${spring.datasource.password}")
	private String DB_PW;

	public void insertMember(Member m) throws Exception {
		Class.forName(DB_DRIVER);
		String sql = "insert into member(nickname, pwd, email) values(?, ?, ?)";
		
		try(
			Connection con=DriverManager.getConnection(DB_URL, DB_USER, DB_PW);
			PreparedStatement stmt = con.prepareStatement(sql);
			) {
			stmt.setString(1, m.getNickname());
			stmt.setString(2, m.getPwd());
			stmt.setString(3, m.getEmail());
			int i = stmt.executeUpdate();
			
			System.out.println(i+"í–‰ì´ insert ë˜ì—ˆìŠµë‹ˆë‹¤.");
		}
	}
}
```

#### 4. ì„œë¹„ìŠ¤ ê³„ì¸µ (Service) : MemberService.java
ğŸ”¹ DAOë¥¼ í˜¸ì¶œí•˜ì—¬ íšŒì› ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ì—­í• 

```java
package com.shop.cafe.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.shop.cafe.dao.MemberDao;
import com.shop.cafe.dto.Member;

@Service
public class MemberService {
	@Autowired
	MemberDao memberDao;
	
	public void insertMember(Member m) throws Exception {
		memberDao.insertMember(m);
	}
}
```

#### 5. ì»¨íŠ¸ë¡¤ëŸ¬ (Controller) : MemberController.java
ğŸ”¹ REST API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì œê³µí•˜ì—¬ íšŒì›ê°€ì… ìš”ì²­ì„ ì²˜ë¦¬       

- `@RestController` : JSON ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ê¸° ìœ„í•´ ì‚¬ìš©
- `@PostMapping("insertMember")` : í”„ë¡ íŠ¸ì—ì„œ ìš”ì²­í•œ íšŒì› ê°€ì…ì„ ì²˜ë¦¬
- `@RequestBody` : í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë³´ë‚¸ JSON ë°ì´í„°ë¥¼ Member ê°ì²´ë¡œ ë³€í™˜
    -  bodyë¥¼ ë°›ì•„ì™€ì¤˜ë¼ëŠ” ëœ»ì„ !
```java
package com.shop.cafe.controller;

import java.util.HashMap;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

import com.shop.cafe.dto.Member;
import com.shop.cafe.service.MemberService;

@RestController
@CrossOrigin("http://127.0.0.1:5500/")
public class MemberController {
	
	@Autowired
	MemberService memberService;
	
	@PostMapping("insertMember")
	public Map<String, String> insertMember(@RequestBody Member m) {
		
		Map<String, String> responseData = new HashMap();
		try {
			memberService.insertMember(m);
			responseData.put("msg", "ok");
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			responseData.put("msg", e.getMessage());
		}	
		return responseData;
	}
}
```

#### ë°±ì—”ë“œì—ì„œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” í”„ë¡œì„¸ìŠ¤
<img src="/assets/post/2025/ureca/day27_class_3.png" alt='' width=1300px>

---

### í”„ë¡ íŠ¸ì—”ë“œ (FRONT)
#### index.js (íšŒì›ê°€ì… ì´ë²¤íŠ¸ ì²˜ë¦¬)
- ì‚¬ìš©ìê°€ ì…ë ¥í•œ íšŒì›ê°€ì… ì •ë³´ë¥¼ ì„œë²„ì— ì „ì†¡
- ì„œë²„ì—ì„œ ok ì‘ë‹µì„ ë°›ìœ¼ë©´ ëª¨ë‹¬ì„ ë‹«ê³  UI ë³€ê²½
    - íšŒì›ê°€ì… ì‹¤íŒ¨ ì‹œ alert ë©”ì‹œì§€ ì¶œë ¥

```js
document.getElementById("signupBtn").addEventListener("click", async () => {
  const nickname = document.getElementById("nickname").value;
  const email = document.getElementById("email").value;
  const pwd = document.getElementById("pwd").value;
  const data = { nickname, email, pwd };
  let response = await fetch("http://localhost:8080/insertMember", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(data),
  });
  response = await response.json();
  console.log(response);
  if (response.msg === "ok") {
    console.log("ok");
    const modal = bootstrap.Modal.getInstance(
      document.getElementById("signupModal")
    );
    modal.hide();
    document.getElementById(
      "loginSpan"
    ).innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" width="24" height="24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75" />
</svg>`;
    document.getElementById("signupLi").remove();
  } else {
    alert(response.msg);
  }
});
```

## ê²°ê³¼ í™”ë©´
### ì´ˆê¸° í™”ë©´ : íšŒì›ê°€ì… ë²„íŠ¼ í™œì„±í™”
<img src="/assets/post/2025/ureca/day27_res_1.png" alt='' width=1300px>

### íšŒì›ê°€ì… ì •ë³´ ì…ë ¥
<img src="/assets/post/2025/ureca/day27_res_2.png" alt='' width=1300px>

### ê°€ì… ë²„íŠ¼ í´ë¦­ -> ì½˜ì†”ì— ok ë©”ì‹œì§€ ì¶œë ¥
<img src="/assets/post/2025/ureca/day27_res_3.png" alt='' width=1300px>

### STS4 ì½˜ì†” ë¡œê·¸ : "1 í–‰ì´ insert ë˜ì—ˆìŠµë‹ˆë‹¤." í™•ì¸
<img src="/assets/post/2025/ureca/day27_res_4.png" alt='' width=1300px>

### MySQL í…Œì´ë¸” í™•ì¸ : ìƒˆë¡œìš´ íšŒì› ë°ì´í„° ì‚½ì… ì™„ë£Œ
<img src="/assets/post/2025/ureca/day27_res_5.png" alt='' width=1300px>

---

## END
