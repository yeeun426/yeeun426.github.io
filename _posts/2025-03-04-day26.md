---
title: "[Day26] SQL ë¬¸ë²• & ì‹¤ìŠµ"
categories: [Ureca, SQL]
tags: [Git]
image:
  path: /assets/post/2025/ureca/day26.png
  alt: java
published: true
---

## SQL ê¸°ë³¸ ë¬¸ë²• ì •ë¦¬

### ğŸ“Œ ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± 
```sql
CREATE DATABASE IF NOT EXISTS `w3schools` 
/*!40100 DEFAULT CHARACTER SET utf8 */;
```

---

## ğŸ“Œ ë°ì´í„° ì¡°íšŒ (SELECT)
### ì¤‘ë³µ ì œê±° (DISTINCT)
```sql
SELECT DISTINCT country FROM customers;
```

<img src="/assets/post/2025/ureca/sql1.png" alt='' width=1300px>

```sql
SELECT COUNT(DISTINCT country) FROM customers; -- ì¤‘ë³µ ì œê±° í›„ ê°œìˆ˜
SELECT COUNT(*) FROM customers; -- ì¤‘ë³µ ë¯¸ì œê±° ê°œìˆ˜ (ì „ì²´ í–‰ ê°œìˆ˜)
```

<img src="/assets/post/2025/ureca/sql2.png" alt='' width=1300px>


### ë³„ì¹­ (Alias)
```sql
SELECT MIN(Price) AS SmallestPrice FROM Products;

SELECT COUNT(*) AS DistinctCountries
FROM (SELECT DISTINCT country FROM customers) AS c;
```

### ì¡°ê±´ ê²€ìƒ‰ (WHERE)
```sql
SELECT * FROM Customers WHERE Country = 'Mexico';
```
- `<>` : ê°™ì§€ ì•ŠìŒ
- `BETWEEN` : íŠ¹ì • ë²”ìœ„ ë‚´ ê°’ ì„ íƒ
- `LIKE` : íŠ¹ì • íŒ¨í„´ ê²€ìƒ‰
- `IN` : ì—¬ëŸ¬ ê°œì˜ ê°’ ì¤‘ í•˜ë‚˜ ì„ íƒ

---

## ğŸ“Œ ì •ë ¬ (ORDER BY)
```sql
SELECT * FROM Customers
ORDER BY Country ASC, CustomerName DESC;
```
- `ASC` : ì˜¤ë¦„ì°¨ìˆœ (ê¸°ë³¸ê°’)
- `DESC` : ë‚´ë¦¼ì°¨ìˆœ

---

## ğŸ“Œ íŒ¨í„´ ê²€ìƒ‰ (LIKE) 
```sql
SELECT * FROM Customers WHERE CustomerName LIKE 'a%'; -- 'a'ë¡œ ì‹œì‘
SELECT * FROM Customers WHERE city LIKE 'L_nd__'; -- íŠ¹ì • íŒ¨í„´ ë§¤ì¹­
SELECT * FROM Customers WHERE city LIKE '%L%'; -- 'L' í¬í•¨
SELECT * FROM Customers WHERE CustomerName LIKE 'La%'; -- 'La'ë¡œ ì‹œì‘
SELECT * FROM Customers WHERE CustomerName LIKE '%a'; -- 'a'ë¡œ ëë‚¨
SELECT * FROM Customers WHERE CustomerName LIKE '%or%'; -- 'or' í¬í•¨
```
- `%` : 0ê°œ ì´ìƒ ë¬¸ì í¬í•¨ ê°€ëŠ¥
- `_` : ì •í™•íˆ í•œ ë¬¸ì ë§¤ì¹­

---

## ğŸ“Œ ë°ì´í„° ì œí•œ (LIMIT)
```sql
SELECT column_name(s)
FROM table_name
WHERE condition
LIMIT number;
```

---

## ğŸ“Œ ì§‘ê³„ í•¨ìˆ˜ (MIN, MAX, COUNT)
```sql
SELECT MIN(Price) FROM Products;
SELECT MAX(Price) FROM Products;
```

```sql
SELECT MIN(Price) AS SmallestPrice, CategoryID
FROM Products
GROUP BY CategoryID;
```

---

## ğŸ”´ SQL ì¡°ì¸ (JOIN)

| JOIN ì¢…ë¥˜ | ì˜ˆì œ ì½”ë“œ | ì„¤ëª… |
|---|---|---|
| **INNER JOIN** | ``` SELECT * FROM orders o INNER JOIN customers c ON o.customerid = c.customerid; ``` | ì£¼ë¬¸í•œ ê³ ê° ëª…ë‹¨ |
| **LEFT JOIN** | ``` SELECT * FROM orders o LEFT JOIN customers c ON o.customerid = c.customerid; ``` | ëª¨ë“  ì£¼ë¬¸ ì •ë³´ + ê³ ê° ì •ë³´ (ì—†ëŠ” ê²½ìš° NULL) |
| **RIGHT JOIN** | ``` SELECT * FROM orders o RIGHT JOIN customers c ON o.customerid = c.customerid; ``` | ëª¨ë“  ê³ ê° ì •ë³´ + ì£¼ë¬¸ ì •ë³´ (ì—†ëŠ” ê²½ìš° NULL) |
| **FULL OUTER JOIN (MySQL ë¯¸ì§€ì›)** | ```SELECT * FROM orders o FULL OUTER JOIN customers c ON o.customerid = c.customerid; ``` | ëª¨ë“  ì£¼ë¬¸ + ëª¨ë“  ê³ ê° ì •ë³´ (MySQLì—ì„œëŠ” cross joinì´ë¼ëŠ” ê²ƒì´ ìˆê¸°ëŠ” í•˜ë‚˜ ì´ê²ƒì€ â€˜ëª¨ë“  ì£¼ë¬¸ì •ë³´  xëª¨ë“  ê³ ê° ì •ë³´â€™ê°€ ë˜ë¯€ë¡œ ì œëŒ€ë¡œ ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•ŠìŒ) |

---

## ì‡¼í•‘ëª° ë§Œë“¤ê¸°
### ë°±ì—”ë“œ (BACK)
#### 1. ë°ì´í„°ë² ì´ìŠ¤ (MySQL)
- product í…Œì´ë¸”ì„ ìƒì„±í•˜ê³  ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì¶”ê°€
- prodcode(ìƒí’ˆ ì½”ë“œ)ë¥¼ ê¸°ë³¸ í‚¤ë¡œ ì„¤ì •
- prodname(ìƒí’ˆëª…)ì€ ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ unique not null ì œì•½ ì¡°ê±´ ì„¤ì •

```sql
drop table if exists product;

create table product(
prodcode int auto_increment ,
prodname varchar(50) unique not null,
pimg varchar(50) ,
price int not null,
primary key (prodcode)
);

insert into product( prodname, price, pimg)
values
('ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸', 2700, 'ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸.png'),
('ì•„ì´ìŠ¤ ì¹´í˜ë¼ë–¼',3500,'ì•„ì´ìŠ¤ì¹´í˜ë¼ë–¼.png'),
('ì•„ì´ìŠ¤ ì¹´í‘¸ì¹˜ë…¸',3800,'ì•„ì´ìŠ¤ì¹´í‘¸ì¹˜ë…¸.png'),
('ë”°ë“¯í•œ ì•„ë©”ë¦¬ì¹´ë…¸',2500,'í•«ì•„ë©”ë¦¬ì¹´ë…¸.png'),
('ë”°ë“¯í•œ ì¹´í˜ë¼ë–¼',3200,'í•«ì¹´í˜ë¼ë–¼.png'),
('ë”°ë“¯í•œ ì¹´í‘¸ì¹˜ë…¸',3500,'í•«ì¹´í‘¸ì¹˜ë…¸.png');
```

#### 2. ë°ì´í„° ëª¨ë¸(DTO) : Product.java
Product.java (DTO - Data Transfer Object)
- product í…Œì´ë¸”ì˜ ë°ì´í„°ì™€ ë§¤í•‘ë˜ëŠ” ê°ì²´
- prodcode, prodname, pimg, price í•„ë“œë¥¼ ê°€ì§

```java
package com.shop.cafe.dto;

public class Product {
	private int prodcode, price;
	private String prodname,pimg;
	
	public Product(int prodcode, String prodname, String pimg, int price) {
		setProdcode(prodcode);
		setProdname(prodname);
		setPimg(pimg);
		setPrice(price);
	}
	
	public Product() {
		super();
	}
	
	@Override
	public String toString() {
		return "Product [prodcode=" + prodcode + ", prodname=" + prodname + ", pimg=" + pimg + ", price=" + price + "]";
	}
	
	public int getProdcode() {
		return prodcode;
	}
	
	public void setProdcode(int prodcode) {
		this.prodcode = prodcode;
	}
	
	public String getProdname() {
		return prodname;
	}
	
	public void setProdname(String prodname) {
		this.prodname = prodname;
	}
	
	public String getPimg() {
		return pimg;
	}
	
	public void setPimg(String pimg) {
		this.pimg = pimg;
	}
	
	public int getPrice() {
		return price;
	}
	
	public void setPrice(int price) {
		this.price = price;
	}	
}
```

#### 3. ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ(DAO) : ProductDao.java 
ProductDao.java (ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼)
- MySQLê³¼ ì—°ê²°í•˜ì—¬ ìƒí’ˆ ëª©ë¡ì„ ì¡°íšŒí•˜ëŠ” ì—­í• 
- JDBCë¥¼ ì‚¬ìš©í•˜ì—¬ MySQLì˜ `product` í…Œì´ë¸” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
- `getAllProducts()` ë©”ì„œë“œ:
    1. MySQL ë“œë¼ì´ë²„ ë¡œë“œ
    2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
    3. SQL ì‹¤í–‰ (`SELECT * FROM product`)
    4. ì¡°íšŒ ê²°ê³¼ë¥¼ `Product` ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜

```java
package com.shop.cafe.dao;

import java.sql.*;
import java.util.*;

import org.springframework.stereotype.Component;
import org.springframework.web.bind.annotation.CrossOrigin;

import com.shop.cafe.dto.Product;

@Component
public class ProductDao {

	public List<Product> getAllProducts() throws Exception{
		// JDBC 6ë‹¨ê³„
		// 1. ë“œë¼ì´ë²„ ë“±ë¡
		Class.forName("com.mysql.cj.jdbc.Driver");
		
		String url = "jdbc:mysql://localhost:3306/ureca?serverTimezone=UTC"; // ë¡œì»¬ í™˜ê²½ì—ì„œ MySQLì˜ í¬íŠ¸ë²ˆí˜¸ê°€ 3306
		String user = "ureca";
		String pw = "ureca";
		
		String sql = "select * from product";
		
		// try-width-resources ê¸°ëŠ¥ auto closable ê°ì²´ë§Œ í‘œí˜„
		// ê°ì²´ ìƒì„± êµ¬ë¬¸ë§Œ try ì†Œê´„í˜¸ ì•ˆì— ë„£ì„ ìˆ˜ ìˆìŒ.
		try (
			// 2. ì—°ê²°
			Connection con=DriverManager.getConnection(url, user, pw);
			// 3. Statement ìƒì„±
			PreparedStatement stmt=con.prepareStatement("select * from product");
			// 4. SQL ì „ì†¡
			ResultSet rs=stmt.executeQuery();
			){
			// 5. ê²°ê³¼ ë°›ê¸°
			List<Product> list = new ArrayList<>();
			
			while(rs.next()) {
				int prodcode = rs.getInt("prodcode");
				String prodname = rs.getString("prodname");
				String pimg = rs.getString("pimg");
				int price = rs.getInt("price");
				
				list.add(new Product(prodcode, prodname, pimg, price));
			}
			return list;			
		} 
	}
}
```

#### 4. ì„œë¹„ìŠ¤ ê³„ì¸µ (Service) : ProductService.java
ProductService.java (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
- `ProductDao`ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ ê°€ê³µí•˜ëŠ” ì—­í• 
- `@Service` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤í”„ë§ ì„œë¹„ìŠ¤ ë¹ˆìœ¼ë¡œ ë“±ë¡
- `getAllProducts()` ë©”ì„œë“œ: DAOì—ì„œ ì¡°íšŒí•œ ìƒí’ˆ ëª©ë¡ì„ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì „ë‹¬

```java
package com.shop.cafe.service;

import com.shop.cafe.dao.ProductDao;
import com.shop.cafe.dto.Product;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class ProductService {
	
	@Autowired // DI -> new í•´ì£¼ëŠ”ê±°
	ProductDao productDao;
	
	public List<Product> getAllProducts() throws Exception{
		return productDao.getAllProducts();
	}

}
```

#### 5. ì»¨íŠ¸ë¡¤ëŸ¬ (Controller) : ProductController.java
- `@RestController`ë¥¼ ì‚¬ìš©í•˜ì—¬ REST API ì œê³µ
- `@CrossOrigin`ìœ¼ë¡œ CORS ì •ì±… í—ˆìš© (í”„ë¡ íŠ¸ì—”ë“œì—ì„œ API í˜¸ì¶œ ê°€ëŠ¥)
- `getAllProducts()` ì—”ë“œí¬ì¸íŠ¸:
    - http://localhost:8080/getAllProducts ìš”ì²­ ì‹œ `ProductService`ë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒí’ˆ ëª©ë¡ ë°˜í™˜

```java
package com.shop.cafe.controller;

import java.util.*;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import com.shop.cafe.dto.Product;
import com.shop.cafe.service.ProductService;

@RestController
@CrossOrigin("http://127.0.0.1:5500/")
public class ProductController {
	
	@Autowired // DI -> new í•´ì£¼ëŠ”ê±°
	ProductService productService;
	
	@GetMapping("getAllProducts")
	public List<Product> getAllProducts() {
		try {
			System.out.println("getAllProducts ì‹¤í–‰");
			return productService.getAllProducts();
		} catch (Exception e) {
			e.printStackTrace();
			return null;
		}
	}
}
```
#### âœ… http://localhost:8080/getAllProducts
<img src="/assets/post/2025/ureca/getAllProducts.png" alt='' width=1300px>

### í”„ë¡ íŠ¸ì—”ë“œ (FRONT)
#### 1. index.html (ë©”ì¸ í˜ì´ì§€)
```js
<!DOCTYPE html>
<html lang="en">
<head>
<title>Bootstrap 5 Website Example</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<style>
.fakeimg {
	height: 200px;
	background: #aaa;
}
</style>
</head>
<body>
	<div class="px-3 py-1 bg-info text-white text-center d-flex justify-content-between">
		<span>effect!</span> 	
		<span id="loginSpan"></span>
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<div class="container-fluid">
			<ul class="navbar-nav">
				<li class="nav-item" id="signupLi"><a class="nav-link active" href="#"
					data-bs-toggle="modal" data-bs-target="#signupModal">SignUp</a></li>
				<li class="nav-item"><a class="nav-link" href="#">Link</a></li>
				<li class="nav-item"><a class="nav-link" href="#">Link</a></li>
				<li class="nav-item"><a class="nav-link disabled" href="#">Disabled</a>
				</li>
			</ul>
		</div>
	</nav>

	<div class="container mt-5">
		<div class="row" id="productListDiv">  
		</div>
	</div>

	<div class="mt-5 p-4 bg-dark text-white text-center">
		<p>Footer</p>
	</div>
	<!-- signupModal -->
	<div class="modal" id="signupModal">
		<div class="modal-dialog">
			<div class="modal-content">

				<!-- Modal Header -->
				<div class="modal-header">
					<h4 class="modal-title">íšŒì›ê°€ì…</h4>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>

				<!-- Modal body -->
				<div class="modal-body">
					<div class="mb-3 mt-3">
						<label for="nickname" class="form-label">Nickname:</label> <input
							type="text" class="form-control" id="nickname"
							placeholder="Enter nickname" name="nickname">
					</div>
					<div class="mb-3">
						<label for="email" class="form-label">Email:</label> <input
							type="email" class="form-control" id="email"
							placeholder="Enter email" name="email">
					</div>
					<div class="mb-3">
						<label for="pwd" class="form-label">Password:</label> <input
							type="password" class="form-control" id="pwd"
							placeholder="Enter password" name="pswd">
					</div>
					
					<button type="submit" class="btn btn-primary" id="signupBtn">ê°€ì…</button>
				</div>

				<!-- Modal footer -->
				<div class="modal-footer">
					<button type="button" class="btn btn-danger"
						data-bs-dismiss="modal">Close</button>
				</div>

			</div>
		</div>
	</div>
	<script src="./js/index.js"></script>
</body>
</html>
```

#### 2. js/index.js (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¡œì§)
- window.onload ì´ë²¤íŠ¸
    - ì„œë²„ì˜ getAllProducts API í˜¸ì¶œ â†’ ìƒí’ˆ ëª©ë¡ ì¡°íšŒ
    - JSON ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ productListDivì— ë™ì ìœ¼ë¡œ HTML ìƒì„±

```js
window.onload = async () => {
  let productList = await fetch("http://localhost:8080/getAllProducts", {
    method: "GET",
  }); // ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ ë‚´ìš©
  // XMLHttpRequest (XHR)
  // await : ë°ì´í„° ì˜¬ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦´ê²Œ (async ë‚´ë¶€ì—ì„œë§Œ ì“¸ ìˆ˜ ìˆëŠ” í‚¤ì›Œë“œ)
  console.log(productList);
  productList = await productList.json(); // ë°°ì—´ë¡œ
  console.log(productList);

  let productListDiv = ``;
  productList.forEach((item) => {
    productListDiv += `<div class="card m-3" style="width: 10rem;">
                      <img src="img/${item.pimg}" class="card-img-top" alt="...">
                      <div class="card-body">
                        <b class="card-title">${item.prodname}</b>
                        <p class="card-text text-danger">${item.price}</p>
                        <a href="#" class="btn btn-outline-info">ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°</a>
                      </div>
                    </div>`;
  });
  document.getElementById("productListDiv").innerHTML = productListDiv;
};

document.getElementById("signupBtn").addEventListener("click", async () => {
  const nickname = document.getElementById("nickname").value;
  const email = document.getElementById("email").value;
  const pwd = document.getElementById("pwd").value;
  const data = { nickname, email, pwd };
  let response = await fetch("insertMember", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      // 'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: JSON.stringify(data),
  });
  response = await response.json();
  console.log(response);
  if (response.msg === "ok") {
    console.log("ok");
    const modal = bootstrap.Modal.getInstance(
      document.getElementById("signupModal")
    );
    modal.hide();
    //hero icons
    document.getElementById(
      "loginSpan"
    ).innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" width="24" height="24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75" />
</svg>`;
    document.getElementById("signupLi").remove();
  }
});
```

#### âœ… http://127.0.0.1:5500/front/index.html
<img src="/assets/post/2025/ureca/day26.png" alt='' width=1300px>

---

## END