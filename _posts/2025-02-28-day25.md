---
title: "[Day25] SQL ê¸°ì´ˆ & ê¸°ë³¸ ì •ë¦¬"
categories: [Ureca, SQL]
tags: [Git]
image:
  path: /assets/post/2025/ureca/sql.png
  alt: java
published: true
---

# SQL ê¸°ë³¸ ì •ë¦¬

<img src="/assets/post/2025/ureca/sql.webp" alt='' width=1300px>

## SQL ë°ì´í„° íƒ€ì…

| ë°ì´í„° íƒ€ì… | ì„¤ëª… |
|------------|------|
| `varchar` | ê°€ë³€ ê¸¸ì´ ë¬¸ìì—´ (ìµœëŒ€ n ê¸¸ì´) |
| `char` | ê³ ì • ê¸¸ì´ ë¬¸ìì—´ |
| `int` | ì •ìˆ˜í˜• ë°ì´í„° |
| `text` | ê¸´ ë¬¸ìì—´ ë°ì´í„° |
| `date` | ë‚ ì§œ (YYYY-MM-DD) |
| `boolean` | ì°¸/ê±°ì§“ ê°’ |

## ì‚¬ìš©ì ë° ê¶Œí•œ ì„¤ì •
```sql
-- ì‚¬ìš©ì ìƒì„±
CREATE USER 'ureca'@'%' IDENTIFIED BY 'ureca';
-- ëª¨ë“  ê¶Œí•œ ë¶€ì—¬
GRANT ALL PRIVILEGES ON *.* TO 'ureca'@'%' WITH GRANT OPTION;
-- ë³€ê²½ ì‚¬í•­ ì ìš©
FLUSH PRIVILEGES;
```

## DB ìƒì„± ë° ì‚¬ìš©
```sql
-- ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
CREATE DATABASE ureca;

-- ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ
USE ureca;
```

## TABLE
### í…Œì´ë¸” ìƒì„±
```sql
CREATE TABLE `ureca`.`member` (
  id VARCHAR(45) NOT NULL,
  pw VARCHAR(45) NOT NULL,
  name VARCHAR(50) NOT NULL,
  age INT NOT NULL,
  PRIMARY KEY (id)
);
```

### í…Œì´ë¸” êµ¬ì¡° ë³€ê²½
```sql
ALTER TABLE `ureca`.`member` 
ADD COLUMN `id` VARCHAR(45) NOT NULL,
ADD COLUMN `pw` VARCHAR(45) NOT NULL,
CHANGE COLUMN `name` `name` VARCHAR(50) NOT NULL,
CHANGE COLUMN `age` `age` INT NOT NULL,
ADD PRIMARY KEY (`id`);
```

### í…Œì´ë¸” ì‚­ì œ
```sql
DROP TABLE `ureca`.`member`; -- ì™„ì „ ì‚­ì œ (rollback ë¶ˆê°€)
```

## ë°ì´í„° (CRUD)
### ë°ì´í„° ì‚½ì… (INSERT)
```sql
INSERT INTO member(id, pw, name, age) VALUES
('a', 'a', 'í™ê¸¸ë™', 20),
('b', 'b', 'ì´ì˜ˆì€', 30),
('c', 'c', 'ì „ì§€í˜„', 40);
```

### ë°ì´í„° ì¡°íšŒ (SELECT)
```sql
SELECT * FROM member;
```

### ë°ì´í„° ë³€ê²½ (UPDATE)
```sql
update member
set name = 'ì´ì˜ˆì€'
where id = 'b';
```

### ë°ì´í„° ì‚­ì œ (DELETE)
```sql
DELETE FROM member WHERE id = 'a';
```

## ë°ì´í„° ì‚­ì œ ë°©ë²•
```sql
DELETE FROM member;      -- ë°ì´í„°ë§Œ ì‚­ì œ (ROLLBACK ê°€ëŠ¥)
TRUNCATE TABLE member;   -- ë°ì´í„°ë§Œ ì‚­ì œ (ROLLBACK ë¶ˆê°€, AUTO_INCREMENT ì´ˆê¸°í™”)
```

## íŠ¸ëœì­ì…˜ ê´€ë¦¬
```sql
select * from member;
start transaction;
delete from member;
rollback; -- ë³€ê²½ ì‚¬í•­ ì·¨ì†Œ
commit;   -- ë³€ê²½ ì‚¬í•­ ì €ì¥
```

## JDBC ì‚¬ìš©ë²•

- `executeQuery()`: SELECTë¬¸ ì‹¤í–‰, ê²°ê³¼ë¡œ ResultSet ë°˜í™˜
- `executeUpdate()`: INSERT, UPDATE, DELETE ì‹¤í–‰, ë³€ê²½ëœ í–‰ ê°œìˆ˜ ë°˜í™˜
- `execute()`: ëª¨ë“  SQL ì‹¤í–‰ ê°€ëŠ¥ (SELECTì´ë©´ true, DMLì´ë©´ false ë°˜í™˜)

### JDBCë¥¼ ì´ìš©í•œ ë°ì´í„° ì¡°íšŒ (select)
```java
import java.sql.*;

public class Test {
	public static void main(String[] args) {
		// JDBC 6ë‹¨ê³„
		try {
			// 1.Driver ë“±ë¡
			Class.forName("com.mysql.cj.jdbc.Driver");
			
			// 2. Connection
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost/ureca", "ureca", "ureca");
			
			// 3. Statement ìƒì„±
			Statement stmt = con.createStatement();
			
			// 4. SQL ì „
			ResultSet rs = stmt.executeQuery("select * from member");
			// executeQuery : ResultSetì´ return 
			
			// 5. ê²°ê³¼ ì–»ê¸°
			while(rs.next()) {
				String id = rs.getString("id");
				String pw = rs.getString("pw");
				String name = rs.getString("name");
				int age = rs.getInt("age");
				System.out.println(id + " " + pw + " " + name + " " + age);
			}
			
			// 6. ìì› ë‹«ê¸°
			rs.close();
			stmt.close();
			con.close();
			
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
```

### JDBCë¥¼ ì´ìš©í•œ ë°ì´í„° ì‚½ì… (insert)

```java
import java.sql.*;

public class InsertTest {
	public static void main(String[] args) {
		// JDBC 6ë‹¨ê³„
		try {
			// 1.Driver ë“±ë¡
			Class.forName("com.mysql.cj.jdbc.Driver");
			
			// 2. Connection
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost/ureca", "ureca", "ureca");
			// 3. Statement ìƒì„±
			// Statement stmt = con.createStatement();
			PreparedStatement stmt = con.prepareStatement("insert into member(id, pw, name, age) values(?,?,?,?)");
			
			// 4. SQL ì „
			stmt.setString(1, args[0]);
			stmt.setString(2, args[1]);
			stmt.setString(3, args[2]);
			stmt.setInt(4, Integer.parseInt(args[3]));
			
			int i = stmt.executeUpdate();
			
			// 5. ê²°ê³¼ ì–»ê¸°
			System.out.println(i + "í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
			
			// 6. ìì› ë‹«ê¸°
			stmt.close();
			con.close();
			
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
```

---

### PAIR STUDY

```java
import java.awt.*;
import java.awt.event.*;
import java.sql.*;

public class MyWorkbench {
	static Connection con;
	
	public static void main(String[] args) throws Exception {
		Frame f = new Frame();
		TextArea ta = new TextArea();
		Panel p = new Panel();
		TextField tf = new TextField(25);
		
		f.add(ta);
		f.add(p, BorderLayout.SOUTH);
		p.add(tf);
		
		dbSet();
		
		tf.addActionListener(e -> {
			String sql = tf.getText().trim();
			
			try {
				PreparedStatement stmt = con.prepareStatement(sql);
				
				if(sql.startsWith("select")) {
					ResultSet rs = stmt.executeQuery();

				     while (rs.next()) {
				      String id = rs.getString("id");
				      String pw = rs.getString("pw");
				      String name = rs.getString("name");
				      int age = rs.getInt("age");
				      ta.append(id + ":" + pw + ":" + name + ":" + age + "\n");
				     }
				} else {
					int i = stmt.executeUpdate();
					ta.append(i + "í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤." + "\n");
				}
			} catch (SQLException e1) {
				e1.printStackTrace();
			}
		});

		f.addWindowListener(new WindowAdapter() {
			@Override
			public void windowClosing(WindowEvent e) {
				System.exit(0);
			}
		});
		f.setSize(500, 400);
		f.setVisible(true);
	}

	private static void dbSet() throws Exception {
		// 1.Driver ë“±ë¡
		Class.forName("com.mysql.cj.jdbc.Driver");
		// 2. Connection
		con = DriverManager.getConnection("jdbc:mysql://localhost/ureca", "ureca", "ureca");
	}
}
```

#### ê²°ê³¼
âœ… í…Œì´ë¸”ì˜ ê°’ì„ ë³€ê²½í•œ ê²½ìš° (insert, delete ë“±)
<img src="/assets/post/2025/ureca/sqlPair.png" alt='' width=1300px>

âœ… ì „ì²´ í…Œì´ë¸” ë°ì´í„° ë³´ê¸° (select)
<img src="/assets/post/2025/ureca/sqlPair1.png" alt='' width=1300px>

### ğŸ”¹ ê°•ì‚¬ë‹˜ì˜ ë‹µì•ˆ

```java
import java.awt.*;
import java.awt.event.*;
import java.sql.*;


public class MyWorkbench {
	static Connection con;

	public static void main(String[] args) throws Exception {
		Frame f=new Frame();
		TextArea ta=new TextArea();
		Panel p=new Panel();
		TextField tf=new TextField(35);
		
		f.add(ta);
		f.add(p, BorderLayout.SOUTH);
		p.add(tf);
		
		dbSet();
		
		tf.addActionListener(e->{
			String sql=tf.getText().trim();
			try {
				PreparedStatement stmt=con.prepareStatement(sql);a
				
				if(stmt.execute()) {
					ResultSetMetaData rsmd=stmt.getMetaData();
					ResultSet rs=stmt.getResultSet();
					int colCnt=rsmd.getColumnCount();
					
					StringBuilder sb=new StringBuilder();
					while(rs.next()) {
						for (int i = 1; i <= colCnt; i++) {
							sb.append(rs.getString(i)).append(" ");
						}
						sb.append("\n");
					}
					ta.append(sb.toString()+"\n");
				}else {
					int i=stmt.getUpdateCount();
					ta.append(i+"í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤\n\n");
				}
				tf.setText("");
			} catch (SQLException e1) {
				e1.printStackTrace();
			}
			
		});
		
		f.addWindowListener(new WindowAdapter() {
			@Override
			public void windowClosing(WindowEvent e) {
				System.exit(0);
			}
		});
		f.setSize(500, 400);
		f.setVisible(true);
	}

	private static void dbSet() throws Exception {
		//1. Driver ë“±ë¡
		Class.forName("com.mysql.cj.jdbc.Driver");
		//2. Connection
		 con=DriverManager.getConnection("jdbc:mysql://localhost/ureca", "ureca", "ureca");	
	}
}
```

---

## END



