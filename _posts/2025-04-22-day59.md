---
title: "[Day58]ì‡¼í•‘ëª° - ShopPage,Pagination"
categories: [Ureca, React]
tags: [React, JS, Tab, Modal, Cart ]
image:
  path: /assets/post/2025/ureca/day57_class_1.png
  alt: React
published: true
---

URLê³¼ paramsì— ëŒ€í•œ í•µì‹¬ ë‚´ìš©ì€ ë”°ë¡œ í¬ìŠ¤íŒ… í•´ë‘ì—ˆë‹¤ ! <br/>
[URL? URLSearchParams? useSearchParams?](https://yeeun426.github.io/posts/URL/)

----

# Shop

## ê¸°ëŠ¥
- ìƒí’ˆ ëª©ë¡ í˜ì´ì§€
- ì¹´í…Œê³ ë¦¬ í•„í„°ë§
- ì •ë ¬ ê¸°ëŠ¥
- í˜ì´ì§€ë„¤ì´ì…˜
- URL Query íŒŒë¼ë¯¸í„°ë¥¼ í™œìš©í•œ ìƒíƒœ ê´€ë¦¬ `?category=new&_sort=price&_page=2`

### Router ì„¤ì • `router.jsx`

```jsx
{ path: '/shop', element: <ShopPage />, loader: shopPageLoader }
```

- /shop ê²½ë¡œë¡œ ì§„ì… ì‹œ:
    - shopPageLoaderë¡œ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ë¶ˆëŸ¬ì˜¤ê³ 
    - ShopPage ì»´í¬ë„ŒíŠ¸ê°€ í•´ë‹¹ ë°ì´í„°ë¥¼ ë°›ì•„ ë Œë”ë§

### shopPageLoader 

```jsx
export const shopPageLoader = async ({ request }) => {
  const url = new URL(request.url)
  const page = url.searchParams.get('_page') || 1
  const per_page = url.searchParams.get('_per_page') || 12
  const category = url.searchParams.get('category') || ''
  const sort = url.searchParams.get('_sort') || ''

  let queryString = `_page=${page}&_per_page=${per_page}`
  category ? (queryString += `&category=${category}`) : queryString
  sort ? (queryString += `&_sort=${sort}`) : queryString

  try {
    const products = await getProductsData(queryString)
    return { products, per_page }
  } catch (err) {
    console.log('err----', err)
    throw new Response('ìƒí’ˆ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ', {
      status: err.status || 500,
    })
  }
}
```

1. `request.url`ì—ì„œ `query` íŒŒë¼ë¯¸í„° ì¶”ì¶œ
2. í•´ë‹¹ íŒŒë¼ë¯¸í„°ë¡œ API í˜¸ì¶œìš© queryString ìƒì„±
3. `getProductsData(queryString)`ë¡œ ìƒí’ˆ ë°ì´í„° ìš”ì²­
4. ë°˜í™˜ê°’ì€ `{ products, per_page }` í˜•íƒœë¡œ ì „ë‹¬ë¨

> ? requestëŠ”?
>
>

### ShopPage
#### ğŸ”¹ ì¹´í…Œê³ ë¦¬ í•„í„°ë§
```js
const handleCategoryFilter = category => {
    const params = new URLSearchParams(searchParams) // í˜„ì¬ íŒŒë¼ë¯¸í„° ì •ë³´ ìœ ì§€
    params.set('_page', 1) // í˜ì´ì§€ë¥¼ 1ë¡œ ì´ˆê¸°í™”
    params.set('_per_page', per_page) // í˜ì´ì§€ë‹¹ ìƒí’ˆ ìˆ˜ë¥¼ ì„¤ì •
    category ? params.set('category', category) : params.delete('category') // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
    navigate(`/shop/?${params}`) // URL ë³€ê²½
}
```

```jsx
<button
  onClick={() => handleCategoryFilter('new')}
  className={currentCategory === 'new' ? css.active : ''}
>
  ì‹ ìƒí’ˆ(new)
</button>
```
-  í´ë¦­ ì‹œ URL íŒŒë¼ë¯¸í„° ë³€ê²½ â†’ loader ì¬ì‹¤í–‰ â†’ ìƒí’ˆ ì¬ì¡°íšŒ

#### ğŸ”¹ ì •ë ¬ ê¸°ëŠ¥
```js
const handleSort = sortOption => {
    const params = new URLSearchParams(searchParams)
    params.set('_page', 1)
    params.set('_sort', sortOption) // ì„ íƒí•œ ì •ë ¬ ê¸°ì¤€ì„ _sortë¡œ URLì— ë°˜ì˜
    setIsDown(false)
    navigate(`/shop/?${params}`)
}

const sortTextMap = {
    id: 'ë“±ë¡ìˆœ',
    price: 'ë‚®ì€ ê°€ê²©ìˆœ',
    '-price': 'ë†’ì€ ê°€ê²©ìˆœ',
    discount: 'ë‚®ì€ í• ì¸ìˆœ',
    '-discount': 'ë†’ì€ í• ì¸ìˆœ',
}

const getSortText = () => {
    return sortTextMap[sortCase] || 'ë“±ë¡ìˆœ'
}
```

```js
<div className={css.sortHeader} onClick={() => setIsDown(!isDown)}>
  <p>{getSortText()}</p>
</div>
<ul>
  <li onClick={() => handleSort('price')}>ë‚®ì€ ê°€ê²©ìˆœ</li>
</ul>
```

- í† ê¸€ë¡œ ì •ë ¬ ì˜µì…˜ ë…¸ì¶œ
- ì •ë ¬ ì„ íƒ ì‹œ navigate()ë¡œ URL ë³€ê²½ â†’ loader ì¬í˜¸ì¶œ

------

# Pagination

### ì£¼ìš” íë¦„

```jsx
const Pagination = ({ initProductsData }) => {
  const [searchParams] = useSearchParams()
  const navigate = useNavigate()
```

- `initProductsData`: `loader`ì—ì„œ ë°›ì•„ì˜¨ ìƒí’ˆ ë°ì´í„°
- `useSearchParams`: í˜„ì¬ URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì •ë³´ ê°€ì ¸ì˜´
- `navigate`: í˜ì´ì§€ ë³€ê²½ ì‹œ URL ë³€ê²½ìš© í•¨ìˆ˜

### ğŸ”¹ í˜ì´ì§€ ì´ë™ : `handlePageChange`

```js
const handlePageChange = page => {
  const params = new URLSearchParams(searchParams)
  params.set('_page', page)
  navigate(`/shop/?${params}`)
}
```

- `_page` íŒŒë¼ë¯¸í„°ë¥¼ ì›í•˜ëŠ” í˜ì´ì§€ë¡œ ë³€ê²½í•œ í›„ URL ì—…ë°ì´íŠ¸ â†’ `loader` ì¬í˜¸ì¶œë¨

### ğŸ”¹ í˜ì´ì§€ ë²ˆí˜¸ ë°°ì—´ ìƒì„±: `getPageNumbers`

```js
const getPageNumbers = () => {
    // í•œë²ˆì— ë³´ì—¬ì¤„ ìµœëŒ€ í˜ì´ì§€ ë²ˆí˜¸ ìˆ˜
    const maxPageNumbers = 10
    // ì „ì²´ í˜ì´ì§€ê°€ê°€ ìµœëŒ€ í˜ì´ì§€ë³´ë‹¤ ì‘ìœ¼ë©´ ëª¨ë“  í˜ì´ì§€ ë²ˆí˜¸ í‘œì‹œ
    if (pages <= maxPageNumbers) {
      return Array.from({ length: maxPageNumbers }, (_, i) => i + 1)
    }
    // í˜ì´ì§€ê°€ ë§ì„ ê²½ìš° í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì£¼ë³€ ë²ˆí˜¸ ìƒì„±
    // ì˜ˆ) í˜„ì¬ í˜ì´ì§€ 15 => 10 ~ 25ê¹Œì§€ ë³´ì—¬ì¤Œ
    let startPage = Math.max(1, currentPage - Math.floor(maxPageNumbers / 2))
    let endPage = Math.min(pages, startPage + maxPageNumbers - 1)
    startPage = Math.max(1, endPage - maxPageNumbers + 1)

    return Array.from({ length: endPage - startPage + 1 }, (_, i) => startPage + i)
}
```

```jsx
<button onClick={() => handlePageChange(first)}>ì²˜ìŒìœ¼ë¡œ ì´ë™</button>
<button onClick={() => handlePageChange(prev)}><</button>
{pageNumbers.map(...)} // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼
<button onClick={() => handlePageChange(next)}>{'>'}</button>
<button onClick={() => handlePageChange(last)}>ë§ˆì§€ë§‰ í˜ì´ì§€</button>
```

- `first`, `prev`, `next`, `last`ëŠ” ëª¨ë‘ `initProductsData.products`ì—ì„œ ì „ë‹¬ë°›ì€ ê°’
- í˜„ì¬ í˜ì´ì§€ì¼ ê²½ìš° ë¹„í™œì„±í™”(disabled), ë˜ëŠ” ìŠ¤íƒ€ì¼(className) ì²˜ë¦¬

---


## ìƒí’ˆ í˜ì´ì§€ + í˜ì´ì§€ë„¤ì´ì…˜

<img src="/assets/post/2025/ureca/day59_class_1.png" alt='day53' width=1300px>
<img src="/assets/post/2025/ureca/day59_class_2.png" alt='day53' width=1300px>
<img src="/assets/post/2025/ureca/day59_class_3.png" alt='day53' width=1300px>


## END